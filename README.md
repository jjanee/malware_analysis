# malware_analysis
This PCAP contains malware.

1. What is MAC and IP address of infected computer? (2 points)
Dell_02:a8:e4 (5c:26:0a:02:a8:e4)
Internet Protocol Version 4, Src: 172.16.4.193 

2. Which OS that is used in the infected computer? (2 points)
 windows nt6.1

3. What is the host name of infected computer? (2 points)
Stewie-PC

4. Explain the method to obtain the information in problem 1, 2, and 3. (5 points)

Hierarchy หาว่ามีโปรโตคอลไหนที่ใช้สื่อสารบ้าง สมมุติฐานว่า มัลแวร์จะทำงานได้จะต้องมีการใช้โปรโตคอลนั้นมากที่สุด เพื่อที่จะดึงข้อมูลจากhostไป


โปโตคอลที่ใช้มากที่สุดคือ http ที่เป็นแบบ line-base text 
จะเลือกดูแค่ http.request host เปิดconnection กับ serverตัวไหนบ้าง จะดูเฉพาะแค่ header ที่เป็น post 
เพราะหมายถึง host ร้องขอให้ server เตรียมพร้อมเพื่อรอรับข้อมูลที่ host จะส่งไปให้  เป็นช่องทางที่มัลแวร์ทำงาน

เว็บที่ host ส่งไป (
	1. Tyu.benme :
		
	2. p27dokhpz2n7nvgr.1jw2lx.top :
		
	3. Dual.a-0001.a.-msedge.net : เว็บmsnของ ไมโครซอฟ ไม่อยู่ในลิสของanti virus
		
		 
มีสองเว็บที่ใช้ urlscan.io แสกนออกมาไม่ได้ โชว์เป็นช่วงเวลาว่ามีconnection ตอนกี่โมง


เวลาเกิดเหตุอยู่ในช่วง 22:54 -22.57 ทั้ง 6 pkt  
mac add และ ip add เลขเดียวกันทั้งหมด คือ

หาชื่อเครื่อง จาก mac 
Fillter eth.addr == 5c:26:0a:02:a8:e4 and  not tcp 
เลือกไม่โชว์ pkt ที่ไม่โชว์รายละเอียดของเครื่องออก http เข้าเว็บ dns หา server dhcp แจกไอพีให้กับเครื่อง ทำงานแบบใช้พื้นฐาน tcp
จะเหลือโปรโตคอลที่ใช้ browser LLMNR NBNS DHCP ที่ทำงานแบบใช้ UDP
	1. Brower
	2. LLMNR : protocal whois by windows 
	3. NBNS : NetBIOS Name Server
	4. DHCP 
		
		
		
ดูรายละเอียด pkt 2936 http follow จะมีบอกว่าใช้ browser mozilla บน windows nt6.1





 

5. How  does the computer get infected? (3 points)

กดลิ้ง homeimprovement.com/remodeling-your-kitchen-cabinets.html

6. Find and explain the evidence in PCAP that support your answer in problem 5. (5 points)

Pkt 2936 ดู follow  tcp.stream eq 46  เริ่มต้น connection ด้วย get จากreferer ลิ้งนั้น
โดย host ไม่ได้ใช้ชื่อเดียวกันกับ homeimprovement   

แล้วserver  nginx/1.6.2 ตอบกลับมาเป็นscriptอะไรซักอย่าง


ที่ไปติดได้ซึ่งก่อนหน้านี้ stewie sreach in bing.com about remodel home kitchen 
ใน tcp.stream eq 1 at pkt 1876


7. What is the malware's name? (2 points)
Name : Cerber
Type : trojan 

8. Explain how to get the malware's name. (4 points) 
Suspect's destination
1. Tyu.benme :
2. p27dokhpz2n7nvgr.1jw2lx.top :



ip.addr == 194.87.234.129 or ip.addr == 198.105.121.50





 tcp.stream eq 45 Pkt 3112

contain video and vector based animations and sound and are designed for efficient delivery over the web

pktอื่นๆ type เป็น utf8

ในเวลาไล่เลี่ยกัน มีการสร้างconnection รอสองpkt



มีขนาดเท่ากัน

มีheader เป็น script เหมือนกัน
-----------------------------------------ระหว่างนี้ มีbrowser อีกตัวเป็น mozilla version 4.0 เข้า web sportbill แต่ว่าคนนี้น่าจะไม่ใช่ stewie เลยข้ามไป

Pkt 3178-3972 ->UDP


Pkt 3186- 3422



Message ข้างในของทั้งสองอัน
-e7eea3d97c8d008c171000097
-e7eea3d97c8df7
UDP destination
		○ 90.2.1.0–90.2.1.31 (port 6892)
		○ 90.3.1.0–90.3.1.31 (port 6892)
		○ 91.239.24.0–91.239.25.255 (port 6892)
ดูในhtml เจอชื่อ cerber



https://www.sophos.com/en-us/threat-center/threat-analyses/viruses-and-spyware/Troj~Cerber-ACH/detailed-analysis.aspx


Mozilla 4.0






9. Explain the activity of the malware you found in the given evidence. (5 points)









oogle Analytics เป็นเครื่องมือช่วยในการเก็บและวิเคราะห์ข้อมูลที่จะทำให้เราทราบถึงปัญหาหรือโอกาสที่มีอยู่ 



Disconnect เว็บอื่นๆหมด

Stewie reconnect bing again but server was change





